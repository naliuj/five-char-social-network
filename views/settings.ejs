<!DOCTYPE html>
<html>
<%- include('./header.ejs') %>
<div class="container">
    <%- include('./navbar.ejs') %>

    <% if (req.flash('passChange' == 2)) { %>
        <% if (req.flash('passChange') == 1) { %>
            <div class="alert alert-success">
                <%= req.flash('passMessage') %>
            </div>
        <% } else if (req.flash('passChange') == 0) { %>
            <div class="alert alert-danger">
                <%= req.flash('passMessage') %>
            </div>
        <% }; %>
    <% }; %>


    <h3>Settings for <%= req.user.local.username %>:</h3>

    <hr>

    <% if (req.user.local == {} || req.user.local.password == null) { %>
        <div class="well">
            <a href="" class="btn btn-warning" disabled>
                Add a local password.
            </a>
        </div>
    <% } else { %>
        <div class="well">

            <h4>Change Password:</h4><br>

            <form action="/settings" method="post" role="form">
                <div class="formgroup">
                    <label for="old-pass">Old Password:</label>
                    <input type="password" name="oldpass" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newpass">New Password:</label>
                    <input type="password" name="newpass" id="newpass" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="confirmnewpass">Confirm New Password</label>
                    <input type="password" name="confirmnewpass" oninput="check(this)" class="form-control" required>
                </div>
                <input type="submit" value="Change" class="form-control btn btn-success">
            </form>
        </div>
    <% }; %>

</div>
<script type="text/javascript">
	function check(input) {
		if (input.value != document.getElementById("newpass").value) {
			input.setCustomValidity("Password Must Be Matching");
		} else {
			// input is valid -- reset the error message
			input.setCustomValidity('');
		}
	}
</script>
</html>
